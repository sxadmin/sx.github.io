<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Python字符集编码 | Sxadmin blog</title><meta name="description" content="py2与py3的字符编码问题一次性解决"><meta name="keywords" content="编码"><meta name="author" content="Sxadmin"><meta name="copyright" content="Sxadmin"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="https://s1.ax1x.com/2020/06/15/NpA1v6.th.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Python字符集编码"><meta name="twitter:description" content="py2与py3的字符编码问题一次性解决"><meta name="twitter:image" content="https://sxadmin.github.io/img/cover/cover55.png"><meta property="og:type" content="article"><meta property="og:title" content="Python字符集编码"><meta property="og:url" content="https://sxadmin.github.io/2018/10/14/Python%E5%AD%97%E7%AC%A6%E9%9B%86%E7%BC%96%E7%A0%81/"><meta property="og:site_name" content="Sxadmin blog"><meta property="og:description" content="py2与py3的字符编码问题一次性解决"><meta property="og:image" content="https://sxadmin.github.io/img/cover/cover55.png"><meta property="article:published_time" content="2018-10-14T02:47:41.000Z"><meta property="article:modified_time" content="2020-06-14T17:58:12.000Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://sxadmin.github.io/2018/10/14/Python%E5%AD%97%E7%AC%A6%E9%9B%86%E7%BC%96%E7%A0%81/"><link rel="prev" title="Flask flash 消息闪现" href="https://sxadmin.github.io/2018/10/30/Flask-flash-%E6%B6%88%E6%81%AF%E9%97%AA%E7%8E%B0/"><link rel="next" title="Python判断网页编码" href="https://sxadmin.github.io/2018/10/04/Python%E5%88%A4%E6%96%AD%E7%BD%91%E9%A1%B5%E7%BC%96%E7%A0%81/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='https://s1.ax1x.com/2020/06/15/NpPYfx.jpg'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">95</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">66</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">13</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分類</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友鏈</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 關於</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#编码简介"><span class="toc-number">1.</span> <span class="toc-text">编码简介</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ASCII"><span class="toc-number">1.1.</span> <span class="toc-text">ASCII</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ISO-8859"><span class="toc-number">1.2.</span> <span class="toc-text">ISO-8859</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GB2312"><span class="toc-number">1.3.</span> <span class="toc-text">GB2312</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GBK"><span class="toc-number">1.4.</span> <span class="toc-text">GBK</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GB18030"><span class="toc-number">1.5.</span> <span class="toc-text">GB18030</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cp936"><span class="toc-number">1.6.</span> <span class="toc-text">cp936</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#万国码Unicode"><span class="toc-number">1.7.</span> <span class="toc-text">万国码Unicode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UTF-8"><span class="toc-number">1.8.</span> <span class="toc-text">UTF-8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">1.9.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#终端编码"><span class="toc-number">2.</span> <span class="toc-text">终端编码</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Python中编码问题"><span class="toc-number">3.</span> <span class="toc-text">Python中编码问题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#python2"><span class="toc-number">3.1.</span> <span class="toc-text">python2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#列表中打印变成中文"><span class="toc-number">3.1.1.</span> <span class="toc-text">列表中打印变成中文</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#python3"><span class="toc-number">3.2.</span> <span class="toc-text">python3</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#打印乱码常规解决办法"><span class="toc-number">4.</span> <span class="toc-text">打印乱码常规解决办法</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chardet库"><span class="toc-number">5.</span> <span class="toc-text">Chardet库</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#文件读写"><span class="toc-number">6.</span> <span class="toc-text">文件读写</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#中文iso8859-1编码转utf8编码"><span class="toc-number">7.</span> <span class="toc-text">中文iso8859-1编码转utf8编码</span></a></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(/img/cover/cover55.png)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Sxadmin blog</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分類</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友鏈</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 關於</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">Python字符集编码</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2018-10-14 10:47:41"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2018-10-14</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-06-15 01:58:12"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-06-15</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Python%E8%BF%9B%E9%98%B6%E7%AC%94%E8%AE%B0/">Python进阶笔记</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><blockquote class="blockquote-center"> 他盯着覆盖了龙眼的那层坚硬的瞬膜，想到那对在黑暗里缓缓睁开的黄金瞳，仿佛世界之门在他的眼前开启。</blockquote>

<script type="text/javascript" src="/js/src/bai.js"></script>

<h1 id="编码简介"><a href="#编码简介" class="headerlink" title="编码简介"></a>编码简介</h1><h2 id="ASCII"><a href="#ASCII" class="headerlink" title="ASCII"></a>ASCII</h2><p>字母A是65，c是99，~是126等等， ASCII码就这样诞生了。原始的ASCII标准定义了从0到127 的字符，这样正好能用127个字节表示。</p>
<h2 id="ISO-8859"><a href="#ISO-8859" class="headerlink" title="ISO-8859"></a>ISO-8859</h2><p>ISO-8859-1收录的字符除ASCII收录的字符外，还包括西欧语言、希腊语、泰语、阿拉伯语、希伯来语对应的文字符号。</p>
<h2 id="GB2312"><a href="#GB2312" class="headerlink" title="GB2312"></a>GB2312</h2><p>为了满足中文，中国人定制了GB2312,兼容ASCII</p>
<h2 id="GBK"><a href="#GBK" class="headerlink" title="GBK"></a>GBK</h2><p>为了满足了更多的中文，GBK诞生，GBK:2Bytes代表一个字符；为了满足其他国家，各个国家纷纷定制了自己的编码。日本把日文编到Shift_JIS里，韩国把韩文编到Euc-kr里，兼容ASCII，gb2312</p>
<h2 id="GB18030"><a href="#GB18030" class="headerlink" title="GB18030"></a>GB18030</h2><p>为了再满足少数民族的文字，GB18030编码覆盖中、日、朝鲜、少数民族文字，采用单字节、双字节、四字节三种字符编码，维文即使中过少数名字文字又是四字节编码，gb18030没理由不支持转码，经测试发现假设正确。</p>
<h2 id="cp936"><a href="#cp936" class="headerlink" title="cp936"></a>cp936</h2><p>微软的CP936通常被视为等同GBK，连 IANA 也以“CP936”为“GBK”之别名。事实上比较起来， GBK 定义之字符较 CP936 多出95字（15个非汉字及80个汉字）。</p>
<h2 id="万国码Unicode"><a href="#万国码Unicode" class="headerlink" title="万国码Unicode"></a>万国码Unicode</h2><p>有人开始觉得太多编码导致世界变得过于复杂了，让人脑袋疼，于是大家坐在一起拍脑袋想出来一个方法：所有语言的字符都用同一种字符集来表示，这就是Unicode。</p>
<p>Unicode统一用2Bytes代表一个字符，2的16次方-1=65535，可代表6万多个字符，因而兼容万国语言.</p>
<h2 id="UTF-8"><a href="#UTF-8" class="headerlink" title="UTF-8"></a>UTF-8</h2><p>Unicode编码对于通篇都是英文的文本来说，这种编码方式无疑是多了一倍的存储空间（英文字母只需要一个字节就足够,用两个字节来表示,无疑是浪费空间）。于是产生了UTF-8：</p>
<pre><code>UTF-8：对英文字符只用1Bytes表示，对中文字符用3Bytes</code></pre><p>在UTF-8中，0-127号的字符用1个字节来表示，使用和US-ASCII相同的编码。这意味着1980年代写的文档用UTF-8打开一点问题都没有。只有128号及以上的字符才用2个，3个或者4个字节来表示。因此，UTF-8被称作可变长度编码。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><pre><code>unicode：简单粗暴，所有字符都是2Bytes，优点是字符-----&gt;数字的转换速度快，缺点是占用空间大。

utf-8：精准，对不同的字符用不同的长度表示，优点是节省空间，缺点是：字符-&gt;数字的转换速度慢，因为每次都需要计算出字符需要多长的Bytes才能够准确表示。</code></pre><p>因此，内存中使用的编码是unicode，用空间换时间（程序都需要加载到内存才能运行，因而内存应该是尽可能的保证快）；硬盘中或者网络传输用utf-8，网络I/O延迟或磁盘I/O延迟要远大与utf-8的转换延迟，而且I/O应该是尽可能地节省带宽，保证数据传输的稳定性。而把数据存放到硬盘，或者网络传输，都需要把unicode转成utf－8，因为数据的传输，追求的是稳定，高效，数据量越小数据传输就越靠谱，于是都转成utf－8格式的，而不是unicode。</p>
<h1 id="终端编码"><a href="#终端编码" class="headerlink" title="终端编码"></a>终端编码</h1><p>windows下终端指的是CMD控制台，在控制台上输入输出有着其本身的编码格式，如windows控制台输入输出编码都为cp936。</p>
<p><img src="/upload/QQ%E6%88%AA%E5%9B%BE20180814111901.jpg" alt=""></p>
<p>在Linux下是utf-8。</p>
<p>为啥要了解终端编码？</p>
<p>因为你的python程序最终会在CMD下输出运行打印的结果，比如：CMD python xxx.py</p>
<p>在终端执行python脚本时，经常会遇到输出中文乱码，而这往往是因为输出的字符串本身编码与控制台编码不一致。</p>
<h1 id="Python中编码问题"><a href="#Python中编码问题" class="headerlink" title="Python中编码问题"></a>Python中编码问题</h1><p>上面说到内存中使用的编码是unicode，在Python2或者3中运行程序的时候内存中的文字编码都是Unicode。</p>
<p>但是运行中的编码是一回事，文件保存的编码又是一回事。上面提起，存储文本数据的时候如果使用Unicode编码会占用大量的内存，如果存储的时候把文本数据转换成utf-8编码格式来保存，然后取出放到内存的时候编码成Unicode岂不美滋滋？</p>
<p>的确是这么做的，你在win下保存txt文本的时候，在保存为下面有个选择框，让你选择存储编码。在python2中也是这样的，保存python2文件需要在开头加上一行</p>
<pre><code># condig:utf-8</code></pre><p>这就是申明这个文件保存的编码格式为utf-8，如果不加上这一行的话，你在程序中运行中文就会出错，但是python3解决了这个问题。python3中默认的文件编码格式就是utf-8，所以不用加上这一行。</p>
<p>主要说一下decode和encode这两个方法，decode(‘gbk’)的意思就是把gbk编码的字符串转换成unicode编码的字符串，也就是个人理解的编码(世人皆认为这是解码)，encode(‘utf-8’)的意思就是把unicode编码的字符串转换成utf-8编码,也就是个人理解的解码(世人皆认为这是编码)，不过不打紧，你只需要明白他们的作用即可。</p>
<p>并且py中的数据字符串类型都有两种，下面对py字符串编码做下详细区分</p>
<h2 id="python2"><a href="#python2" class="headerlink" title="python2"></a>python2</h2><p>在python2中有两种字符串类型str和unicode，在python2里，str其实就是bytes</p>
<p>代码演示str</p>
<pre><code>C:\Users\Administrator\Desktop&gt;python
Python 2.7.14 (v2.7.14:84471935ed, Sep 16 2017, 20:25:58) [MSC v.1500 64 bit (AMD64)] on win32
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; s = &apos;你好&apos;
&gt;&gt;&gt; s
&apos;\xc4\xe3\xba\xc3&apos;
&gt;&gt;&gt; print s
你好</code></pre><p>直接调用变量s，看到的却是一个个的16进制表示的二进制字节，其实就是bytes类型，即字节类型， 它把8个二进制一组称为一个byte,用16进制来表示。 　</p>
<p>代码演示unicode</p>
<pre><code>&gt;&gt;&gt; s = u&apos;你好&apos;
&gt;&gt;&gt; s
u&apos;\u4f60\u597d&apos;
&gt;&gt;&gt; print s
你好</code></pre><p>Unicode编码是一个反斜杠加上一个字母4，然后拼接4个字符。前面说到内存中使用的编码是unicode，如何让所有输入的字符串都变成Unicode编码呢？同样是上文提到的decode方法。</p>
<p>代码演示编码转换</p>
<pre><code>&gt;&gt;&gt; s = &apos;你好&apos;
&gt;&gt;&gt; s
&apos;\xc4\xe3\xba\xc3&apos;
# 这里编码是str
&gt;&gt;&gt; s.decode(&apos;utf-8&apos;)
# 尝试把s的内容以utf-8编码格式转出Unicode
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;F:\Python27\lib\encodings\utf_8.py&quot;, line 16, in decode
    return codecs.utf_8_decode(input, errors, True)
UnicodeDecodeError: &apos;utf8&apos; codec can&apos;t decode byte 0xc4 in position 0: invalid continuation byte
&gt;&gt;&gt; s.decode(&apos;gbk&apos;)
# 尝试把s的内容以gbk编码格式转出Unicode
u&apos;\u4f60\u597d&apos;
&gt;&gt;&gt; s.decode()
# 尝试把s的内容以默认ascii编码格式转出Unicode
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
UnicodeDecodeError: &apos;ascii&apos; codec can&apos;t decode byte 0xc4 in position 0: ordinal not in range(128)
&gt;&gt;&gt; s.decode(&apos;gb2312&apos;)
# 尝试把s的内容以gb2312编码格式转出Unicode
u&apos;\u4f60\u597d&apos;</code></pre><p>只要是Unicode编码格式的字符串，打印出来都可以正常显示。</p>
<p>其他技巧</p>
<p>我们知道，python的字符串在内存中是unicode编码，存储的时候是utf-8编码保存。</p>
<p>在将unicode存储到文本的过程中，还有一种存储方式，不需要将unicode转换为实际的文本存储字符集，而是将unicode的内存编码值进行存储，读取文件的时候再反向转换回来，是采用：unicode-escape的转换方式。</p>
<p>将unicode编码的内容转化为中文（注意是内容，而不是字符串变量）</p>
<pre><code>a=&quot;\\u8fdd\\u6cd5\\u8fdd\u89c4&quot; #变量a的内容为unicode编码，变量a为string编码（&quot;&quot;前不要加u）
b=a.decode(&apos;unicode-escape&apos;)
print b</code></pre><p>对于utf-8编码的字符串，在存储的时候，通常是直接存储，而实际上也还有一种存储utf-8编码值的方法，即：string-escape。</p>
<p>将string编码的内容转化为中文（注意是内容，而不是字符串变量）</p>
<pre><code>a=&quot;\\xe5\\x85\\xb3\\xe4\\xba\\x8e\\xe4&quot; #变量a的内容为string编码，变量a为string编码（&quot;&quot;前不要加u）
b=a.decode(&apos;string-escape&apos;)
print b</code></pre><p>unicode-escape与utf-8的区别</p>
<pre><code>&gt;&gt;&gt;a=&quot;\u4e0a\u4f20\u6210\u529f&quot;
&gt;&gt;&gt;b=a.decode(&apos;utf-8&apos;)
&gt;&gt;&gt;print type(b)
&lt;type &apos;unicode&apos;&gt;
&gt;&gt;&gt;b
u&apos;\\u4e0a\\u4f20\\u6210\\u529f&apos;
&gt;&gt;&gt;print b
\u4e0a\u4f20\u6210\u529f</code></pre><p>当对变量a做decode(‘utf-8’)时，除了对把变量a的类型从str变成了unicode,a变量的内容也做了utf-8解码，所以多了一些斜杠。</p>
<pre><code>&gt;&gt;&gt;a=&quot;\u4e0a\u4f20\u6210\u529f&quot;
&gt;&gt;&gt;c=a.decode(&quot;unicode-escape&quot;)
&gt;&gt;&gt;print type(c)
&lt;type &apos;unicode&apos;&gt;
&gt;&gt;&gt;c
u&apos;\u4e0a\u4f20\u6210\u529f&apos;
&gt;&gt;&gt;print c
上传成功</code></pre><p>而对变量a做decode(‘unicode-escape’)时，貌似只有变量本身被decode成unicode了，其内容没有发生改变。</p>
<p>我们知道print函数会将变量以及变量内容都encode成str，因此第二个例子能输出中文，而第一个例子输出的还是unicode类型的内容，只不过少了一些斜杠，因为它还需要再encode一次。</p>
<p>当然本例子的转化，有更简单的方法，如下：</p>
<pre><code>&gt;&gt;&gt; d=u&quot;\u4e0a\u4f20\u6210\u529f&quot;  #定义变量d时，前面加个u，将其变成unicode
&gt;&gt;&gt; print d
上传成功</code></pre><h3 id="列表中打印变成中文"><a href="#列表中打印变成中文" class="headerlink" title="列表中打印变成中文"></a>列表中打印变成中文</h3><p>一般来说字典或者列表中的中文字符串直接打印出来的话，会是unicode或者别的编码格式，使用如下方法解决</p>
<pre><code>#coding:utf-8
d = {&apos;user&apos;:&apos;浪子&apos;,
     &apos;password&apos;:&apos;123456&apos;}
print d

&gt;&gt;&gt;{&apos;password&apos;: &apos;123456&apos;, &apos;user&apos;: &apos;\xe6\xb5\xaa\xe5\xad\x90&apos;}

dd = [&apos;中文&apos;,&apos;123456&apos;]
print str(dd)
&gt;&gt;&gt;[&apos;\xe4\xb8\xad\xe6\x96\x87&apos;, &apos;123456&apos;]</code></pre><p>这个dd列表中的中文是字符串编码，如果想打印的时候直接打印原始中文，可以这么做</p>
<pre><code>print str(dd).decode(&quot;string-escape&quot;)#</code></pre><p>如果dd列表中的中文是unicode编码，就是在前面加了一个字母u。</p>
<pre><code>dd = [u&apos;中文&apos;,&apos;123456&apos;]
print str(dd).decode(&quot;unicode-escape&quot;)
&gt;&gt;&gt;[&apos;中文&apos;, &apos;123456&apos;]</code></pre><p>这样打印出来的就是中文</p>
<p>注意：</p>
<p>str表示字符的原始8位值，unicode表示Unicode字符。</p>
<p>在python2中，如果str只包含7位ASCII字符（英文字符），那么unicode与str实例类似于同一种类型（等价的），那么在这种情况下，以下几种操作是正常的：</p>
<ul>
<li>可以用+号连接str与unicode</li>
<li>可以用=与!=来判断str与unicode</li>
<li>可以用’%s’来表示Unicode实例</li>
</ul>
<h2 id="python3"><a href="#python3" class="headerlink" title="python3"></a>python3</h2><p>python3把字符串变成了unicode,文件默认编码变成了utf-8,这意味着，只要用python3,无论你的程序是以哪种编码开发的，都可以在全球各国电脑上正常显示</p>
<p>在python3中有两种字符串类型str和bytes，并且对str 和bytes 做了明确区分， str 就是unicode格式的字符， bytes就是单纯二进制</p>
<p>代码演示str</p>
<pre><code>C:\Users\Administrator\Desktop&gt;python3
Python 3.6.3 (v3.6.3:2c5fed8, Oct  3 2017, 18:11:49) [MSC v.1900 64 bit (AMD64)] on win32
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; s = &apos;你好&apos;
&gt;&gt;&gt; s
&apos;你好&apos;
&gt;&gt;&gt; print(s)
你好
&gt;&gt;&gt; type(s)
&lt;class &apos;str&apos;&gt;
&gt;&gt;&gt; s.decode(&apos;gbk&apos;)
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &apos;str&apos; object has no attribute &apos;decode&apos;
&gt;&gt;&gt; s.encode(&apos;gbk&apos;)
b&apos;\xc4\xe3\xba\xc3&apos;
&gt;&gt;&gt; s = u&apos;你好&apos;
&gt;&gt;&gt; s
&apos;你好&apos;
&gt;&gt;&gt; print(s)
你好
&gt;&gt;&gt; type(s)
&lt;class &apos;str&apos;&gt;</code></pre><p>代码演示bytes</p>
<pre><code>&gt;&gt;&gt; s = &apos;你好&apos;
&gt;&gt;&gt; s.encode(&apos;utf-8&apos;)
b&apos;\xe4\xbd\xa0\xe5\xa5\xbd&apos;
&gt;&gt;&gt; s.encode(&apos;gbk&apos;)
b&apos;\xc4\xe3\xba\xc3&apos;
&gt;&gt;&gt; print(type(s.encode(&apos;gbk&apos;)))
&lt;class &apos;bytes&apos;&gt;</code></pre><p>注意：</p>
<p>bytes表示字符的原始8位值，str表示Unicode字符。将unicode字符表示为二进制数据（原始8位值），最常见的编码方式就是UTF-8。python2与3中的unicode字符没有和特定的二进制编码相关联，因此需要使用encode方法。</p>
<p>在python3中bytes与str是绝对不会等价的，即使字符内容为””，因此在传入字符序列时必须注意其类型。</p>
<pre><code>&apos;&apos;&apos;
对于bytes编码的数据来说
只有decode方法
就是把bytes编码的数据转换成utf-8编码

对于utf-8编码的数据来说
只有encode方法
就是把utf-8编码的数据转换成bytes编码
&apos;&apos;&apos;
a = &apos;浪子&apos;
print(a.encode())
# 默认是编码成bytes
print(a.encode(&apos;gbk&apos;))
# 将utf-8编码格式转换成gbk编码格式
print(a.encode().decode(&apos;utf-8&apos;))
print(a.encode(&apos;gbk&apos;).decode(&apos;gbk&apos;))
# 相同编码格式必须要用相同编码才能解码</code></pre><h1 id="打印乱码常规解决办法"><a href="#打印乱码常规解决办法" class="headerlink" title="打印乱码常规解决办法"></a>打印乱码常规解决办法</h1><p>如果不想在打印输出的时候每个都加上decode的话，这两个方法可以帮到你</p>
<ol>
<li><p>在开头加上这三行代码（仅Python2）</p>
<p> import sys<br> reload(sys)<br> sys.setdefaultencoding(‘utf-8’)</p>
</li>
<li><p>在开头加上这两行代码</p>
<p> import sys,io<br> sys.stdout = io.TextIOWrapper(sys.stdout.buffer,encoding=’gb18030’) #改变标准输出的默认编码</p>
</li>
</ol>
<h1 id="Chardet库"><a href="#Chardet库" class="headerlink" title="Chardet库"></a>Chardet库</h1><p>chardet是Python社区提供了一个类库包，方便我们在代码中动态检测当前页面或者文件中的编码格式信息。</p>
<pre><code>import chardet
f = open(&apos;file&apos;,&apos;r&apos;)
fencoding=chardet.detect(f.read())
print fencoding

fencoding输出格式 {&apos;confidence&apos;: 0.96630842899499614, &apos;encoding&apos;: &apos;GB2312&apos;} </code></pre><p>只能判断是否为某种编码的概率。比较准确的结果了。输入参数为str类型。</p>
<p>一个实例，判断网页编码：</p>
<pre><code>url = &apos;https://stackoverflow.com&apos;
d1 = requests.get(url)
print d1.content
if isinstance(d1.content,unicode):
    pass
else:
    codesty = chardet.detect(d1.content)
    a = d1.content.decode(codesty[&apos;encoding&apos;])</code></pre><p>常见编码错误的原因有：</p>
<ol>
<li>Python解释器的默认编码</li>
<li>Python源文件文件编码</li>
<li>Terminal使用的编码</li>
<li>操作系统的语言设置</li>
</ol>
<h1 id="文件读写"><a href="#文件读写" class="headerlink" title="文件读写"></a>文件读写</h1><p><a href="https://sxadmin.github.io/Python%20文件读写%20模块.html">Python 文件读写</a></p>
<h1 id="中文iso8859-1编码转utf8编码"><a href="#中文iso8859-1编码转utf8编码" class="headerlink" title="中文iso8859-1编码转utf8编码"></a>中文iso8859-1编码转utf8编码</h1><p>在项目中使用wget 进行ftp下载文件时，由于ftp下载默认的是ascii模式，下载的文件编码是iso8859-1。</p>
<p>在python3中直接使用open函数的话，需要设置编码，不然会报错。</p>
<pre><code>open(&quot;08M0063639_20170710.txt&quot;,&quot;r&quot;,encoding=&apos;iso8859-1&apos;)</code></pre><p>这样做，假如文本是数字或者字母的时候，没有什么影响。但文本是中文的时候，获取的数据是iso8859-1编码的，进行数据操作时会出现乱码。<br>所以要将数据转化为utf8编码</p>
<pre><code>uft_str = str.encode(&quot;iso-8859-1&quot;).decode(&apos;gbk&apos;).encode(&apos;utf8&apos;)</code></pre><p>先将文本转化成gbk编码，然后在从gbk编码变成utf8编码。<br>原理：</p>
<p>utf8编码的文本可以用iso8859-1的编码表示，但是反过来不行。iso8859-1是单字节编码，而utf8是定长编码，从utf8转化成iso8859-1相当于是高精度转化成低精度，造成精度丢失，所以不可逆。根本原因是因为utf8中文，在iso8859-1没有匹配的位置。</p>
<p>而gbk是不定长编码，英文数字的字符编码规则跟iso8859-1是一样的，所以gbk是兼容iso8859-1编码的，这两者可以相互转换。</p>
<p><a href="https://www.cnblogs.com/vipchenwei/p/6993788.html" target="_blank" rel="noopener">1</a></p>
<p><a href="https://sxadmin.github.io/Python判断字符串的开头与结尾.html">2</a></p>
<p><a href="https://sxadmin.github.io/Python判断网页编码.html">3</a></p>
<p><a href="https://thief.one/2017/04/18/1/" target="_blank" rel="noopener">4</a></p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Sxadmin</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://sxadmin.github.io/2018/10/14/Python%E5%AD%97%E7%AC%A6%E9%9B%86%E7%BC%96%E7%A0%81/">https://sxadmin.github.io/2018/10/14/Python%E5%AD%97%E7%AC%A6%E9%9B%86%E7%BC%96%E7%A0%81/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://sxadmin.github.io" target="_blank">Sxadmin blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%BC%96%E7%A0%81/">编码</a></div><div class="post_share"><div class="social-share" data-image="/img/cover/cover116.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2018/10/30/Flask-flash-%E6%B6%88%E6%81%AF%E9%97%AA%E7%8E%B0/"><img class="prev_cover" src="/img/cover/cover95.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Flask flash 消息闪现</div></div></a></div><div class="next-post pull_right"><a href="/2018/10/04/Python%E5%88%A4%E6%96%AD%E7%BD%91%E9%A1%B5%E7%BC%96%E7%A0%81/"><img class="next_cover" src="/img/cover/cover55.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Python判断网页编码</div></div></a></div></nav></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Sxadmin</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script></body></html>