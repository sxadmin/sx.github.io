<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>PHP常识进阶笔记 | Sxadmin blog</title><meta name="description" content="在PHP的基础之上一些稍微复杂点的知识，包括文件操作，过滤器机制等等。"><meta name="keywords" content="PHP基础快速入门"><meta name="author" content="Sxadmin"><meta name="copyright" content="Sxadmin"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="https://s1.ax1x.com/2020/06/15/NpA1v6.th.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="PHP常识进阶笔记"><meta name="twitter:description" content="在PHP的基础之上一些稍微复杂点的知识，包括文件操作，过滤器机制等等。"><meta name="twitter:image" content="https://sxadmin.github.io/img/cover/cover16.png"><meta property="og:type" content="article"><meta property="og:title" content="PHP常识进阶笔记"><meta property="og:url" content="https://sxadmin.github.io/2018/05/12/PHP%E5%B8%B8%E8%AF%86%E8%BF%9B%E9%98%B6%E7%AC%94%E8%AE%B0/"><meta property="og:site_name" content="Sxadmin blog"><meta property="og:description" content="在PHP的基础之上一些稍微复杂点的知识，包括文件操作，过滤器机制等等。"><meta property="og:image" content="https://sxadmin.github.io/img/cover/cover16.png"><meta property="article:published_time" content="2018-05-12T04:36:22.000Z"><meta property="article:modified_time" content="2020-06-15T03:37:31.242Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://sxadmin.github.io/2018/05/12/PHP%E5%B8%B8%E8%AF%86%E8%BF%9B%E9%98%B6%E7%AC%94%E8%AE%B0/"><link rel="prev" title="PHP之杂项函数" href="https://sxadmin.github.io/2018/05/12/PHP%E4%B9%8B%E6%9D%82%E9%A1%B9%E5%87%BD%E6%95%B0/"><link rel="next" title="PHP的String函数笔记" href="https://sxadmin.github.io/2018/05/11/PHP%E4%B9%8BString%E5%87%BD%E6%95%B0%E7%AC%94%E8%AE%B0/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='https://s1.ax1x.com/2020/06/15/NpPYfx.jpg'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">88</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">60</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">10</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分類</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友鏈</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 關於</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#文件包含"><span class="toc-number">1.</span> <span class="toc-text">文件包含</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#案例一："><span class="toc-number">1.1.</span> <span class="toc-text">案例一：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#案例二"><span class="toc-number">1.2.</span> <span class="toc-text">案例二</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#文件处理"><span class="toc-number">2.</span> <span class="toc-text">文件处理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Cookie"><span class="toc-number">3.</span> <span class="toc-text">Cookie</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#删除COOKIE"><span class="toc-number">3.1.</span> <span class="toc-text">删除COOKIE</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#错误-异常-捕获异常处理"><span class="toc-number">4.</span> <span class="toc-text">错误&#x2F;异常&#x2F;捕获异常处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#创建一个异常的类"><span class="toc-number">4.1.</span> <span class="toc-text">创建一个异常的类</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#操作MYSQL数据库"><span class="toc-number">5.</span> <span class="toc-text">操作MYSQL数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#连接数据库与关闭"><span class="toc-number">5.1.</span> <span class="toc-text">连接数据库与关闭</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建数据库与表"><span class="toc-number">5.2.</span> <span class="toc-text">创建数据库与表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#增加数据"><span class="toc-number">5.3.</span> <span class="toc-text">增加数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#获取表单提交的内容"><span class="toc-number">5.4.</span> <span class="toc-text">获取表单提交的内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查询数据"><span class="toc-number">5.5.</span> <span class="toc-text">查询数据</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#文件上传"><span class="toc-number">6.</span> <span class="toc-text">文件上传</span></a></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(/img/cover/cover16.png)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Sxadmin blog</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分類</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友鏈</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 關於</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">PHP常识进阶笔记</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2018-05-12 12:36:22"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2018-05-12</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-06-15 11:37:31"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-06-15</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/PHP%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/">PHP基础笔记</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><blockquote class="blockquote-center">人小时候总是鄙夷“酒肉朋友”这四个字，长大后才发现，在你最难过的时候，只有喝杯酒和大块吃肉能让你稍微舒服些。某种意义上说酒肉才是你永恒的好朋友，因为它们从不弃你而去，所以世界上伤心的胖子越来越多。</blockquote>

<script type="text/javascript" src="/js/src/bai.js"></script>

<h1 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h1><p>文件包含有点类似Python中的包，你可以自己写包然后在另一个脚本中调用你自己写的包，PHP的文件包含有两个函数include与require，看看他们的区别：</p>
<ul>
<li>require 生成一个致命错误（E_COMPILE_ERROR），在错误发生后脚本会停止执行。</li>
<li>include 生成一个警告（E_WARNING），在错误发生后脚本会继续执行。</li>
</ul>
<p>区别就是require出错了就停止了并且报错，include出错了还可以继续执行。</p>
<h2 id="案例一："><a href="#案例一：" class="headerlink" title="案例一："></a>案例一：</h2><p>在当前目录下有一个index.php，里面的内容是：</p>
<pre><code>&lt;?php
header(&quot;Content-type: text/html; charset=utf-8&quot;);
echo &apos;www.sxadmin.github.io&apos;;
echo &quot;&lt;br&gt;&quot;;
echo &apos;不将就&apos;;
?&gt;</code></pre><p>同目录下新建一个PHP文件：</p>
<pre><code>&lt;?php
header(&quot;Content-type: text/html; charset=utf-8&quot;);
include &apos;index.php&apos;;
?&gt;</code></pre><p>运行结果：</p>
<pre><code>www.sxadmin.github.io
不将就</code></pre><p>如果使用require的话就直接把include改掉就ok。</p>
<h2 id="案例二"><a href="#案例二" class="headerlink" title="案例二"></a>案例二</h2><p>上面只是一个简单的包含调用，如果你包含调用的文件中有变量需要你使用的话，看看下面的例子。</p>
<p>首先写一个菜单超链接文件，并且包含两个变量$name与$age，内容如下：</p>
<pre><code>&lt;?php
header(&quot;Content-type: text/html; charset=utf-8&quot;);
echo &apos;&lt;a href=&quot;/&quot;&gt;首页&lt;/a&gt;
&lt;a href=&quot;/phpinfo.php&quot;&gt;info信息&lt;/a&gt;
&lt;a href=&quot;/l.php&quot;&gt;探针&lt;/a&gt;&apos;;
$name=&apos;langzi&apos;;
$age=&apos;22&apos;;
?&gt;</code></pre><p>运行结果：</p>
<p><img src="upload/include-1.jpg" alt=""></p>
<p>点击探针的话或跳转过去的哟~</p>
<p><img src="upload/include-2.jpg" alt=""></p>
<p>这个时候我可以调用后直接使用被调用的文件内的变量哦~</p>
<pre><code>&lt;html&gt;
&lt;body&gt;
&lt;div class=&quot;leftmenu&quot;&gt;
&lt;?php
header(&quot;Content-type: text/html; charset=utf-8&quot;);
include &apos;index.php&apos;;
echo &apos;&lt;hr&gt;&apos;;
echo $name.&apos;&lt;br&gt;&apos;;
echo $age;
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p>运行结果：</p>
<p><img src="upload/include-3.jpg" alt=""></p>
<h1 id="文件处理"><a href="#文件处理" class="headerlink" title="文件处理"></a>文件处理</h1><p>就像Python中打开处理文本一样，除了格式上略有不同。</p>
<pre><code>&lt;?php
header(&quot;Content-type: text/html; charset=utf-8&quot;);
// 设置编码
$file = fopen(&quot;index.txt&quot;, &quot;r&quot;) or exit(&quot;无法打开文件!&quot;);
// 打开文件，如果不存在输输出无法打开文件
while(!feof($file))
{
    echo fgets($file). &quot;&lt;br&gt;&quot;;
}
// 读取文件每一行，直到文件结尾
fclose($file);
// 关闭文件
?&gt;</code></pre><p>相关函数：</p>
<ul>
<li><p>feof() 函数检测是否已到达文件末尾（EOF）。</p>
<p>  if (feof($file)) echo “文件结尾”;</p>
</li>
<li><p>fgets() 函数用于从文件中逐行读取文件。在调用该函数之后，文件指针会移动到下一行。</p>
</li>
<li><p>fgetc() 函数用于从文件中逐字符地读取文件。在调用该函数之后，文件指针会移动到下一个字符。</p>
</li>
</ul>
<p>关于PHP中文件操作还有很多知识点，这里不一一列举，详细请参考<a href="http://www.runoob.com/php/php-ref-filesystem.html" target="_blank" rel="noopener">PHP文件操作</a></p>
<h1 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h1><p>使用setcookie()创建cookies，注意setcookie() 函数必须位于 <html> 标签之前。下面的例子是先创建一个cookie值，有效时间为一个小时</p>
<pre><code>&lt;?php
setcookie(&quot;langzi&quot;, &quot;zhaohan&quot;, time()+3600);
?&gt;
&lt;html&gt;
&lt;?php
// 输出 cookie 值
echo $_COOKIE[&quot;langzi&quot;];
echo &apos;&lt;hr&gt;&apos;;
// 查看所有 cookie
print_r($_COOKIE);
?&gt;
&lt;/html&gt;</code></pre><p>运行结果：</p>
<pre><code>zhaohan
--------------------------------------------------
Array ( [langzi] =&gt; zhaohan [Pycharm-31941b8e] =&gt; 016cf837-253e-4bd4-bebc-bb57ec4bdc6e [Phpstorm-d94e29df] =&gt; 9ab3f44d-78b3-48ff-9a0d-621a484e0cdf )</code></pre><h2 id="删除COOKIE"><a href="#删除COOKIE" class="headerlink" title="删除COOKIE"></a>删除COOKIE</h2><pre><code>&lt;?php
// 设置 cookie 过期时间为过去 1 小时
setcookie(&quot;langzi&quot;, &quot;&quot;, time()-3600);
?&gt;</code></pre><h1 id="错误-异常-捕获异常处理"><a href="#错误-异常-捕获异常处理" class="headerlink" title="错误/异常/捕获异常处理"></a>错误/异常/捕获异常处理</h1><p>PHP中对错误异常的处理比Python中要多一些，错误处理PHP中可以使用die()函数来处理，但是重点还是放在异常处理与异常捕获上面。</p>
<ul>
<li>Try - 和Python中一样。</li>
<li>Throw - 里规定如何触发异常。有点像Python异常处理里面的raise抛出异常，但是在PHP当中你先定义出现异常的条件，每一个 “throw” 必须对应至少一个 “catch”。如果抛出了异常，就必须捕获它。</li>
<li>Catch - 和Python中的Exception一样，”catch” 代码块会捕获异常，并创建一个包含异常信息的对象。</li>
</ul>
<p>案例：</p>
<pre><code>&lt;?php
header(&quot;Content-type: text/html; charset=utf-8&quot;);
// 创建一个有异常处理的函数
function checkNum($number)
{
    if($number&gt;1)
    {
        throw new Exception(&quot;变量值必须小于等于 1&quot;);
        // 出现异常的条件，新建一个异常对象
    }
    return true;
}

// 在 try 块 触发异常
try
{
    checkNum(2);
    // 如果抛出异常，以下文本不会输出
    echo &apos;okok&apos;;
    //如果是正常的话就执行上面的输出okok，但是传入参数2大于1，会出现异常
}
// 捕获异常
catch(Exception $e)
    // 这里就像Python的 except Exception as e
{
    echo &apos;Message: &apos; .$e-&gt;getMessage();
}
?&gt;</code></pre><p>运行结果：</p>
<pre><code>Message: 变量值必须小于等于 1</code></pre><h2 id="创建一个异常的类"><a href="#创建一个异常的类" class="headerlink" title="创建一个异常的类"></a>创建一个异常的类</h2><p>就像Python的类class一样，PHP中创建自定义的异常处理程序非常简单。我们简单地创建了一个专门的类，当 PHP 中发生异常时，可调用其函数。该类必须是 exception 类的一个扩展。<br>这个自定义的 customException 类继承了 PHP 的 exception 类的所有属性，可向其添加自定义的函数。：</p>
<pre><code>&lt;?php
header(&quot;Content-type: text/html; charset=utf-8&quot;);
class customException extends Exception
// 从Exception继承过来，类似Py的class(exception)它从旧类继承了属性和方法，我们可以使用 exception 类的方法，比如 getLine()、getFile() 和 getMessage()。
{
    public function errorMessage()
        // 公共属性，这个类的每个函数都能使用这个公共的函数
    {
        // 错误信息
        $errorMsg = &apos;错误行号 &apos;.$this-&gt;getLine().&apos; in &apos;.$this-&gt;getFile().&apos;: &lt;b&gt;&apos;.$this-&gt;getMessage().&apos;&lt;/b&gt; 不是一个合法的 E-Mail 地址&apos;;
        //
        return $errorMsg;
    }
}

$email = &quot;someone@example...com&quot;;

try
{
    // 检测邮箱
    if(filter_var($email, FILTER_VALIDATE_EMAIL) === FALSE)
    {
        // 如果是个不合法的邮箱地址，抛出异常
        throw new customException($email);
    }
}

catch (customException $e)
{
//display custom message
    echo $e-&gt;errorMessage();
}
?&gt;</code></pre><p>运行结果：</p>
<pre><code>错误行号 22 in E:\PHPSTUDY\PHPTutorial\WWW\PHP study5-10\PHP-base\php-exeption.php: someone@example...com 不是一个合法的 E-Mail 地址</code></pre><p>在类中public是用来声明公共作用域中的属性。公共属性，就是可以有相应的对象直接操作和访问的。</p>
<h1 id="操作MYSQL数据库"><a href="#操作MYSQL数据库" class="headerlink" title="操作MYSQL数据库"></a>操作MYSQL数据库</h1><p>就像在Python中操作数据库一样，在PHP中使用mysql_xx()函数可以直接对MYSQL数据库进行连接关闭与增删改查。</p>
<h2 id="连接数据库与关闭"><a href="#连接数据库与关闭" class="headerlink" title="连接数据库与关闭"></a>连接数据库与关闭</h2><pre><code>&lt;?php
mysql_connect(&quot;localhost:3306&quot;,&apos;root&apos;,&apos;root&apos;);
mysql_close();
?&gt;</code></pre><p>和Python中的oymysql一样，首先定义一个数据库连接，最后关闭连接。定义一个变量$coon当作这个数据库的连接变量。如果连接失败就报个异常。</p>
<pre><code>&lt;?php
$coon = mysql_connect(&apos;localhost:3306&apos;,&apos;roottt&apos;,&apos;root&apos;);
if (!$coon)  {
    echo &apos;Could not connect: &apos; . mysql_error();
}
?&gt;</code></pre><p>运行结果：</p>
<pre><code>Warning: mysql_connect(): Access denied for user &apos;roottt&apos;@&apos;localhost&apos; (using password: YES) in E:\PHPSTUDY\PHPTutorial\WWW\PHP study5-10\PHP-base\php_mysql.php on line 2
Could not connect: Access denied for user &apos;roottt&apos;@&apos;localhost&apos; (using password: YES)</code></pre><h2 id="创建数据库与表"><a href="#创建数据库与表" class="headerlink" title="创建数据库与表"></a>创建数据库与表</h2><pre><code>&lt;?php
/**
 * Created by PhpStorm.
 * User: Sxadmin
 * Blog: sxadmin.github.io
 * Date: 2018/5/18 0018
 * Time: 15:08
 */

header(&quot;Content-type: text/html; charset=utf-8&quot;);
$coon = mysql_connect(&apos;127.0.0.1&apos;,&apos;root&apos;,&apos;root&apos;);
if (!$coon){
    echo &apos;连接数据库失败&apos;.mysql_error();
}
//创建一个数据库 lang
if (mysql_query(&apos;create database lang&apos;,$coon)){
    echo &apos;数据库创建成功&apos;;
}else{
    echo &apos;数据库创建失败&apos;.mysql_error();
}
// 在lang数据库创建一个表 msg
// 首先选择数据库，使用mysql_select_db
mysql_select_db(&apos;lang&apos;);
// 然后开始创建表了
// 就像在Python中一样，你可以把SQL语句放在一个变量里面,注意这里的语法不一样,括号内容不要加引号
$sql = &apos;create table msg(
    name varchar(10),
    age varchar(10)
)&apos;;
// 执行这条SQL语句
if (mysql_query($sql,$coon)){
    echo &apos;msg表创建成功&apos;;
}else{
    echo &apos;msg表创建失败&apos;.mysql_error();
}
mysql_close();
?&gt;</code></pre><p>运行结果：</p>
<pre><code>数据库创建成功msg表创建成功</code></pre><p>数据库中也多了lang这个数据库，其中有msg这个表，可以增加一个自增长的ID作为主键，此时SQL语句可以这么写。</p>
<pre><code>$sql = &quot;CREATE TABLE Persons 
(
personID int NOT NULL AUTO_INCREMENT, 
PRIMARY KEY(personID),
FirstName varchar(15),
LastName varchar(15),
Age int
)&quot;;</code></pre><h2 id="增加数据"><a href="#增加数据" class="headerlink" title="增加数据"></a>增加数据</h2><p>和Python中一样，知道MYSQL的基础语法就好了，增删改查与pymysql一样，只是记住PHP的语法比如括号引号要注意即可。</p>
<pre><code>&lt;?php
/**
 * Created by PhpStorm.
 * User: Sxadmin
 * Blog: sxadmin.github.io
 * Date: 2018/5/18 0018
 * Time: 15:32
 */

header(&quot;Content-type: text/html; charset=utf-8&quot;);
$coon = mysql_connect(&apos;localhost:3306&apos;,&apos;root&apos;,&apos;root&apos;);
if (!$coon){
    echo &apos;数据库连接失败&apos;.mysql_error().&apos;&lt;br&gt;&apos;;
}else{
    echo &apos;数据库连接成功&apos;.&apos;&lt;br&gt;&apos;;
}
mysql_select_db(&apos;lang&apos;);
$sql=&quot;insert into msg(name,age) values (&apos;langzi&apos;,&apos;18&apos;)&quot;;
if (!mysql_query($sql,$coon)){
    echo &apos;数据插入失败&lt;br&gt;&apos;;
}else{
    echo &apos;数据插入成功&lt;br&gt;&apos;;
}
mysql_close($coon);
?&gt;</code></pre><p>运行结果：</p>
<pre><code>数据库连接成功
数据插入成功</code></pre><p>查看数据库，可以看到数据插进去了…</p>
<pre><code>name|langzi            
age    |18            </code></pre><h2 id="获取表单提交的内容"><a href="#获取表单提交的内容" class="headerlink" title="获取表单提交的内容"></a>获取表单提交的内容</h2><pre><code>$sql=&quot;INSERT INTO Persons (Name, Age)  VALUES  (&apos;$_POST[name]&apos;,&apos;$_POST[age]&apos;)&quot;;</code></pre><h2 id="查询数据"><a href="#查询数据" class="headerlink" title="查询数据"></a>查询数据</h2><pre><code>&lt;?php
/**
 * Created by PhpStorm.
 * User: Sxadmin
 * Blog: sxadmin.github.io
 * Date: 2018/5/18 0018
 * Time: 15:32
 */

header(&quot;Content-type: text/html; charset=utf-8&quot;);
$coon = mysql_connect(&apos;localhost:3306&apos;,&apos;root&apos;,&apos;root&apos;);
if (!$coon){
    echo &apos;数据库连接失败&apos;.mysql_error().&apos;&lt;br&gt;&apos;;
}else{
    echo &apos;数据库连接成功&apos;.&apos;&lt;br&gt;&apos;;
}
mysql_select_db(&apos;lang&apos;);
$sql=&quot;select * from msg&quot;;
$result = mysql_query($sql,$coon);
if (!$result){
    echo &apos;数据查询失败&lt;br&gt;&apos;.mysql_error();
}else{
    echo &apos;数据查询成功&lt;br&gt;&apos;;
    // 这里和pymysql一样，用一个变量存储获取到的数据
    while($row = mysql_fetch_array($result))
        // 打印这个变量
    {
        echo $row[&apos;name&apos;] . &quot; &quot; . $row[&apos;age&apos;];
        echo &quot;&lt;br /&gt;&quot;;
    }
}
mysql_close($coon);
?&gt;</code></pre><p>运行结果：</p>
<pre><code>数据库连接成功
数据查询成功
langzi 18</code></pre><p>要注意的是，这个迭代遍历的结果的值必须与数据库的字段名一致，比如$row[‘name’]就不能用$row[‘naaame’]。</p>
<p>后面的改与删除都和pymysql差不多，只要记住php的语法结构上的差别即可。</p>
<h1 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h1><p>这个是一个很大的类目，在后面的安全审计中占用很重要的地位，看看php怎么实现文件上传先参考<a href="https://sxadmin.github.io/PHP常识基础笔记.html">PHP基础</a></p>
<p>测试上传文件有一个文件夹和两个文件</p>
<pre><code>|-----upload             # 文件上传的目录
|-----form.html          # 表单文件
|-----upload_file.php    # php 上传代码</code></pre><p>让我们来逐一分析这些代码：</p>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;title&gt;langzi-test-upload&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;form action=&quot;upload_file.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
    &lt;!--提交到当目录下的upload_file.php文件--&gt;
&lt;!--application/x-www-form-urlencoded是只能上传文本格式的文件，multipart/form-data是将文件以二进制的形式上传，这样可以实现多种类型的文件上传 --&gt;
    &lt;label for=&quot;file&quot;&gt;文件名：&lt;/label&gt;
    &lt;!--label 元素不会向用户呈现任何特殊的样式。不过，它为鼠标用户改善了可用性，因为如果用户点击 label 元素内的文本，则会切换到控件本身。--&gt;
    &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot;&gt;&lt;br&gt;
    &lt;!--选择文件框框--&gt;
    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;
    &lt;!--上传文件按钮--&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><p>运行结果：</p>
<p><img src="upload/upload-1.jpg" alt=""></p>
<p>继续分析上传的PHP代码：</p>
<pre><code>&lt;?php
header(&quot;Content-type: text/html; charset=utf-8&quot;);
$allowedExts = array(&quot;gif&quot;, &quot;jpeg&quot;, &quot;jpg&quot;, &quot;png&quot;);
// 数组内保存是允许上传的文件后缀
$temp = explode(&quot;.&quot;, $_FILES[&quot;file&quot;][&quot;name&quot;]);
//explode把字符串变成数组，这个就像Python的字典变成JSON一样，不过只是像并非性质一样。参考https://sxadmin.github.io/PHP之String函数笔记.html
//通过使用 PHP 的全局数组 $_FILES，你可以从客户计算机向远程服务器上传文件。
echo $_FILES[&quot;file&quot;][&quot;size&quot;];
// 输出文件名和大小
$extension = end($temp);
// 获取文件后缀名
if ((($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/gif&quot;)
|| ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/jpeg&quot;)
|| ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/jpg&quot;)
|| ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/pjpeg&quot;)
|| ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/x-png&quot;)
|| ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/png&quot;))
&amp;&amp; ($_FILES[&quot;file&quot;][&quot;size&quot;] &lt; 204800)
// 小于 200 kb
&amp;&amp; in_array($extension, $allowedExts))
    // in_array() 函数搜索数组中是否存在指定的值。
// php中的关系运算符：&amp;&amp;（and）、||（or）、xor（亦或）、！（非）
{
    if ($_FILES[&quot;file&quot;][&quot;error&quot;] &gt; 0)
    // 上传文件的返回信息中如果出现error这个单词就说明上传失败，有点类似Py中的find(&apos;error&apos;)&gt;0
    {
        echo &quot;错误：: &quot; . $_FILES[&quot;file&quot;][&quot;error&quot;] . &quot;&lt;br&gt;&quot;;
    }
    else
    {
        echo &quot;上传文件名: &quot; . $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot;&lt;br&gt;&quot;;
        echo &quot;文件类型: &quot; . $_FILES[&quot;file&quot;][&quot;type&quot;] . &quot;&lt;br&gt;&quot;;
        echo &quot;文件大小: &quot; . ($_FILES[&quot;file&quot;][&quot;size&quot;] / 1024) . &quot; kB&lt;br&gt;&quot;;
        echo &quot;文件临时存储的位置: &quot; . $_FILES[&quot;file&quot;][&quot;tmp_name&quot;] . &quot;&lt;br&gt;&quot;;

        // 判断当期目录下的 upload 目录是否存在该文件
        // 如果没有 upload 目录，你需要创建它，upload 目录权限为 777
        if (file_exists(&quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]))
        {
            echo $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot; 文件已经存在。 &quot;;
        }
        else
        {
            // 如果 upload 目录不存在该文件则将文件上传到 upload 目录下
            move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;], &quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]);
            echo &quot;文件存储在: &quot; . &quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;];
        }
    }
}
else
{
    echo &quot;非法的文件格式&quot;;
}
?&gt;</code></pre><p>选择文件再上传</p>
<p><img src="upload/upload-2.jpg" alt=""></p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Sxadmin</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://sxadmin.github.io/2018/05/12/PHP%E5%B8%B8%E8%AF%86%E8%BF%9B%E9%98%B6%E7%AC%94%E8%AE%B0/">https://sxadmin.github.io/2018/05/12/PHP%E5%B8%B8%E8%AF%86%E8%BF%9B%E9%98%B6%E7%AC%94%E8%AE%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://sxadmin.github.io" target="_blank">Sxadmin blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/PHP/">PHP</a></div><div class="post_share"><div class="social-share" data-image="/img/cover/cover6.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2018/05/12/PHP%E4%B9%8B%E6%9D%82%E9%A1%B9%E5%87%BD%E6%95%B0/"><img class="prev_cover" src="/img/cover/cover18.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">PHP之杂项函数</div></div></a></div><div class="next-post pull_right"><a href="/2018/05/11/PHP%E4%B9%8BString%E5%87%BD%E6%95%B0%E7%AC%94%E8%AE%B0/"><img class="next_cover" src="/img/cover/cover9.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">PHP的String函数笔记</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2018/05/11/PHP之String函数笔记/" title="PHP的String函数笔记"><img class="relatedPosts_cover" src="/img/cover/cover9.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2018-05-11</div><div class="relatedPosts_title">PHP的String函数笔记</div></div></a></div><div class="relatedPosts_item"><a href="/2018/05/12/PHP之杂项函数/" title="PHP之杂项函数"><img class="relatedPosts_cover" src="/img/cover/cover18.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2018-05-12</div><div class="relatedPosts_title">PHP之杂项函数</div></div></a></div><div class="relatedPosts_item"><a href="/2018/05/10/PHP常识基础笔记/" title="PHP常识基础笔记"><img class="relatedPosts_cover" src="/img/cover/cover0.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2018-05-10</div><div class="relatedPosts_title">PHP常识基础笔记</div></div></a></div></div><div class="clear_both"></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By Sxadmin</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script></body></html>