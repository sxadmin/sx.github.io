<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Django-表单处理 | Sxadmin blog</title><meta name="description" content="使用Django处理表单内容，非常贴心"><meta name="author" content="Sxadmin"><meta name="copyright" content="Sxadmin"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="https://s1.ax1x.com/2020/06/15/NpA1v6.th.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Django-表单处理"><meta name="twitter:description" content="使用Django处理表单内容，非常贴心"><meta name="twitter:image" content="https://sxadmin.github.io/img/cover/cover105.png"><meta property="og:type" content="article"><meta property="og:title" content="Django-表单处理"><meta property="og:url" content="https://sxadmin.github.io/2019/07/08/Django-%E8%A1%A8%E5%8D%95%E5%A4%84%E7%90%86/"><meta property="og:site_name" content="Sxadmin blog"><meta property="og:description" content="使用Django处理表单内容，非常贴心"><meta property="og:image" content="https://sxadmin.github.io/img/cover/cover105.png"><meta property="article:published_time" content="2019-07-08T13:56:35.000Z"><meta property="article:modified_time" content="2019-07-10T06:18:59.000Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://sxadmin.github.io/2019/07/08/Django-%E8%A1%A8%E5%8D%95%E5%A4%84%E7%90%86/"><link rel="prev" title="Django-模板层" href="https://sxadmin.github.io/2019/07/11/Django-%E6%A8%A1%E6%9D%BF%E5%B1%82/"><link rel="next" title="Django-知识回顾做个小DEMO" href="https://sxadmin.github.io/2019/07/07/Django-%E7%9F%A5%E8%AF%86%E5%9B%9E%E9%A1%BE%E5%81%9A%E4%B8%AA%E5%B0%8FDEMO/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='https://s1.ax1x.com/2020/06/15/NpPYfx.jpg'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">90</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">62</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">11</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分類</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友鏈</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 關於</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#使用表单"><span class="toc-number">1.</span> <span class="toc-text">使用表单</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#自动渲染格式"><span class="toc-number">2.</span> <span class="toc-text">自动渲染格式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#手动渲染格式"><span class="toc-number">3.</span> <span class="toc-text">手动渲染格式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#使用直接获取方式"><span class="toc-number">3.1.</span> <span class="toc-text">使用直接获取方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用迭代表方式获取"><span class="toc-number">3.2.</span> <span class="toc-text">使用迭代表方式获取</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#渲染表单错误信息"><span class="toc-number">4.</span> <span class="toc-text">渲染表单错误信息</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#使用-CSS-样式表"><span class="toc-number">5.</span> <span class="toc-text">使用 CSS 样式表</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#后端处理"><span class="toc-number">5.1.</span> <span class="toc-text">后端处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用前端处理"><span class="toc-number">5.2.</span> <span class="toc-text">使用前端处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#半自动处理"><span class="toc-number">5.3.</span> <span class="toc-text">半自动处理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#上传文件"><span class="toc-number">6.</span> <span class="toc-text">上传文件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#走FORMS"><span class="toc-number">6.1.</span> <span class="toc-text">走FORMS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#走MODELS"><span class="toc-number">6.2.</span> <span class="toc-text">走MODELS</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#前端表单常用属性"><span class="toc-number">7.</span> <span class="toc-text">前端表单常用属性</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#表单内置的Field类"><span class="toc-number">8.</span> <span class="toc-text">表单内置的Field类</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-BooleanField"><span class="toc-number">8.1.</span> <span class="toc-text">1. BooleanField</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-DecimalField"><span class="toc-number">8.2.</span> <span class="toc-text">7. DecimalField</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(/img/cover/cover105.png)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Sxadmin blog</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分類</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友鏈</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 關於</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">Django-表单处理</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2019-07-08 21:56:35"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-07-08</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2019-07-10 14:18:59"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2019-07-10</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/WEB-%E5%90%8E%E7%AB%AF%E6%A1%86%E6%9E%B6/">WEB 后端框架</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><blockquote class="blockquote-center">这个世界像是蒙着一层白雾，看不清这个世界也看不见自己，只是感觉到脚下还踩着坚实的土地，由此证明自己还活着，除了自己一无所有。</blockquote>

<script type="text/javascript" src="/js/src/bai.js"></script>



<h1 id="使用表单"><a href="#使用表单" class="headerlink" title="使用表单"></a>使用表单</h1><p>以前提交表单内容数据都是在HTML中写一个表单，然后发送到后端，后端进行处理。</p>
<p>但是在Django中变得简单明了，首先在应用的目录下新建一个forms.py</p>
<pre><code># NHDZ/app/forms.py

# coding:utf-8
from django import forms
import datetime
class Login(forms.Form):
    username = forms.CharField(label=&apos;用户名&apos;, widget=forms.TextInput, initial=&apos;admin&apos;, label_suffix=&apos;:x:&apos;,required=True)
    # 这里设置表单传送过来的数据，并且自动在前端生成表单
    # label 表单的前缀显示  &apos;用户名:&apos;
    # widget   类型为text
    # initial 输入框内的默认值 为 admin
    # label_suffix 后缀，默认是 用户名: 现在变成了  用户名:x:
    # required 给字段添加必填属性，不能空着。

    password = forms.CharField(label=&apos;密码&apos;, widget=forms.PasswordInput, initial=datetime.date.today(),help_text=&apos;在这里输入你的密码&apos;)
    # initial 默认值 可以动态获取日期
    # help_text 帮助文档</code></pre><p>然后就能在视图中编写登陆部分的功能</p>
<pre><code># NHDZ/app/login.py

# coding:utf-8
from .froms import Login
from django.shortcuts import render
from django.http import HttpResponse

def index(request):
    # 登陆页面
    login_form = Login()
    # 实例化表单，然后把表单的内容获取后，渲染到html页面
    return render(request, &apos;login.html&apos;, {&apos;login_form&apos;: login_form})


def login(request):
    # 登陆验证
    if request.method == &apos;POST&apos;:
        do_login = Login(request.POST)
        # 实例化传递过来的数据
        if do_login.is_valid():
            # 判断数据是否合法
            username = do_login.cleaned_data[&apos;username&apos;]
            # 这里的 cleaned_data方法可以清洗数据，然后获取数据
            passowrd = do_login.cleaned_data[&apos;password&apos;]
            return HttpResponse(username + &apos;&lt;br&gt;&apos; + passowrd)</code></pre><p>然后在templates文件夹新建一个login.html文件，内容如下</p>
<pre><code>&lt;form action=&quot;{%url 'login_success'%}&quot; , method=&apos;POST&apos;&gt;
    {% csrf_token %}
    {{login_form}}
&lt;button type=&quot;submit&quot;&gt;登陆&lt;/button&gt;
&lt;/form&gt;</code></pre><p>最后修改一些路由文件urls.py</p>
<pre><code># NHDZ/app/urls.py

from django.urls import path
from .views import Index,Add_Images,Add_Texts
from .show import show
from .login import index,login
urlpatterns = [
    path(&apos;&apos;,Index,name=&apos;index&apos;),
    path(&apos;add_texts/&apos;,Add_Texts,name=&apos;add_texts&apos;),
    path(&apos;add_images/&apos;,Add_Images,name=&apos;add_images&apos;),
    path(&apos;show/&lt;str:user&gt;&apos;,show,name=&apos;show&apos;),
    path(&apos;login/&apos;,index,name=&apos;login&apos;),
    path(&apos;login_success/&apos;,login,name=&apos;login_success&apos;)
]</code></pre><p>这个时候添加功能差不多完成了，访问一下看看是不是生成了表单</p>
<p><img src="/upload/TIM%E6%88%AA%E5%9B%BE20190710100629.png" alt=""></p>
<p>点击登陆后，返回结果</p>
<p><img src="/upload/TIM%E6%88%AA%E5%9B%BE20190710102059.png" alt=""></p>
<h1 id="自动渲染格式"><a href="#自动渲染格式" class="headerlink" title="自动渲染格式"></a>自动渲染格式</h1><p>在演示的login.html中，我只是传入了  就自动生成了表单，但是样式还是非常简陋的，这里使用Django提供自带的样式表渲染就可以变得美美哒</p>
<ol>
<li> 将表单渲染成一个表格元素，每个输入框作为一个<tr>标签</li>
<li> 将表单的每个输入框包裹在一个<p>标签内 tags</li>
<li> 将表单渲染成一个列表元素，每个输入框作为一个<li>标签


</li>
</ol>
<p>注意：你要自己手动编写<table>和<ul>标签。</p>
<p>比如我现在把login.html文件修改成这样</p>
<pre><code>&lt;form action=&quot;{%url 'login_success'%}&quot; , method=&apos;POST&apos;&gt;
    {% csrf_token %}
    {{login_form.as_p}}
&lt;button type=&quot;submit&quot;&gt;登陆&lt;/button&gt;</code></pre><p>现在前端显示的表的样式就变成酱紫</p>
<p><img src="/upload/TIM%E6%88%AA%E5%9B%BE20190710104259.png" alt=""></p>
<h1 id="手动渲染格式"><a href="#手动渲染格式" class="headerlink" title="手动渲染格式"></a>手动渲染格式</h1><p>在希望引用bootstrap时候，需要手动渲染每个地方的样式表，可以通过如下方式进行获取到表的内容，然后进行渲染</p>
<h2 id="使用直接获取方式"><a href="#使用直接获取方式" class="headerlink" title="使用直接获取方式"></a>使用直接获取方式</h2><p>可以使用  表单.属性 的方式获取到表单的内容输入</p>
<pre><code>&lt;form action=&quot;{%url 'login_success'%}&quot; , method=&apos;POST&apos;&gt;
    {% csrf_token %}

&lt;p&gt;用户id:{{ login_form.username }}&lt;/p&gt;

# 这里的 login_form.username 就是直接从表单中获取到数据，然后可以自己添加样式

&lt;h2&gt;密码:{{login_form.password}}

&lt;button type=&quot;submit&quot;&gt;登陆&lt;/button&gt;</code></pre><h2 id="使用迭代表方式获取"><a href="#使用迭代表方式获取" class="headerlink" title="使用迭代表方式获取"></a>使用迭代表方式获取</h2><p>传入的数据进行迭代</p>
<pre><code>&lt;form action=&quot;{%url 'login_success'%}&quot; , method=&apos;POST&apos;&gt;
    {% csrf_token %}
    {% for field in login_form %}

		# 这里对传入的表单迭代

	  <p>{{ field.label_tag }}:{{ field }}

		# field 是表单输入的内容，field.label_tag 是表单的样式表
		# 然后使用 p 标签进行渲染，当然可以把p标签替换css样式
 
	  	</p>
	   {{ field.errors }}

		# 如果表单错误，提示错误内容

	 {% endfor %}
&lt;button type=&quot;submit&quot;&gt;登陆&lt;/button&gt;</code></pre><h1 id="渲染表单错误信息"><a href="#渲染表单错误信息" class="headerlink" title="渲染表单错误信息"></a>渲染表单错误信息</h1><p>在表单里处理错误信息。对于每一个表单字段的错误，它其实会实际生成一个无序列表，参考下面的样子：</p>
<pre><code>&lt;ul class=&quot;errorlist&quot;&gt;
    &lt;li&gt;Sender is required.&lt;/li&gt;
&lt;/ul&gt;</code></pre><p>这个列表有个默认的CSS样式类errorlist，如果你想进一步定制这个样式，可以循环错误列表里的内容，然后单独设置样式：</p>
<pre><code>{% if login_form.errors %}
	    <ol>
	    {% for error in form.username.errors %}
	        <li><strong>{{ error|escape }}</strong></li>
	    {% endfor %}
	    </ol>
	{% endif %}</code></pre><p>一切非字段的错误信息，比如表单的错误，隐藏字段的错误都保存在中，上面的例子，我们把它放在了表单的外围上面，它将被按下面的HTML和CSS格式渲染：</p>
<pre><code>&lt;ul class=&quot;errorlist nonfield&quot;&gt;
    &lt;li&gt;Generic validation error&lt;/li&gt;
&lt;/ul&gt;</code></pre><h1 id="使用-CSS-样式表"><a href="#使用-CSS-样式表" class="headerlink" title="使用 CSS 样式表"></a>使用 CSS 样式表</h1><p>总结了一下，可以通过三种(说到底就是两种)方式设置层叠样式表</p>
<h2 id="后端处理"><a href="#后端处理" class="headerlink" title="后端处理"></a>后端处理</h2><p>在Django编写forms.py表单模型的时候，能够通过设置Field类的属性设置样式，比如</p>
<pre><code>class Login(forms.Form):
    username = forms.CharField(label=&apos;用户名&apos;, widget=forms.TextInput(attrs={&apos;size&apos;: &apos;20&apos;}))
    # 代表大小为20px</code></pre><p>然后 在templates的login.html修改成</p>
<pre><code>&lt;form action=&quot;{%url 'login_success'%}&quot; , method=&apos;POST&apos;&gt;
    {% csrf_token %}

{{login_form}}

&lt;button type=&quot;submit&quot;&gt;登陆&lt;/button&gt;</code></pre><p>结果如下</p>
<p><img src="/upload/TIM%E6%88%AA%E5%9B%BE20190710134158.png" alt=""></p>
<h2 id="使用前端处理"><a href="#使用前端处理" class="headerlink" title="使用前端处理"></a>使用前端处理</h2><p>如上文的手动渲染格式一样，使用field.xxx获取表单的属性，然后自己在前端html编写css</p>
<p><strong>需要注意的是，如果你在前端手动获取了表单的内容数据后然后自己写css渲染后，后端代码中设置的样式不起作用</strong></p>
<h2 id="半自动处理"><a href="#半自动处理" class="headerlink" title="半自动处理"></a>半自动处理</h2><p>前端框架习惯bootstrap，实践后发现能通过前后端设置bootstrap的属性，我为了省事儿没有在static文件夹保存bootstrap的文件，直接引用了</p>
<p>后端代码如下：</p>
<pre><code>class Login(forms.Form):
    username = forms.CharField(label=&apos;用户名&apos;, widget=forms.TextInput(attrs={&apos;class&apos;: &apos;form-control&apos;}))
    # class:form-control 是bootstrap的输入框的一个样式</code></pre><p>前端代码如下：</p>
<pre><code>&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;登陆&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css&quot; integrity=&quot;sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u&quot; crossorigin=&quot;anonymous&quot;&gt;

    # 通过这直接远程引用了bootstrap

&lt;/head&gt;
&lt;body&gt;
&lt;form action=&quot;{%url 'login_success'%}&quot; , method=&apos;POST&apos;&gt;
    {% csrf_token %}
&lt;div class=&quot;col-md-3&quot;&gt;

# 这里是属于bootartap的一个栅栏样式

{{login_form}}

&lt;button type=&quot;submit&quot;&gt;登陆&lt;/button&gt;
&lt;/form&gt;
&lt;/div&gt;</code></pre><p>返回的结果：</p>
<p><img src="/upload/TIM%E6%88%AA%E5%9B%BE20190710135650.png" alt=""></p>
<p>熟悉的界面~</p>
<h1 id="上传文件"><a href="#上传文件" class="headerlink" title="上传文件"></a>上传文件</h1><h2 id="走FORMS"><a href="#走FORMS" class="headerlink" title="走FORMS"></a>走FORMS</h2><p>首先，写一个form模型，它必须包含一个FileField：</p>
<pre><code># forms.py
from django import forms

class UploadFileForm(forms.Form):
    title = forms.CharField(max_length=50)
    file = forms.FileField()</code></pre><p>处理这个表单的视图将在request.FILES中收到文件数据，可以用request.FILES[‘file’]来获取上传文件的具体数据，其中的键值‘file’是根据file = forms.FileField()的变量名来的。</p>
<p><strong>注意：request.FILES只有在请求方法为POST,并且提交请求的<form>具有enctype=”multipart/form-data”属性时才有效。 否则，request.FILES将为空。</strong></p>
<p>下面是一个接收上传文件的视图范例：</p>
<pre><code># views.py

from django.http import HttpResponseRedirect
from django.shortcuts import render
from .forms import UploadFileForm

# 另外写一个处理上传过来的文件的方法，并在这里导入
from somewhere import handle_uploaded_file

def upload_file(request):
    if request.method == &apos;POST&apos;:
        form = UploadFileForm(request.POST, request.FILES) # 注意获取数据的方式
        if form.is_valid():
            handle_uploaded_file(request.FILES[&apos;file&apos;])
            return HttpResponseRedirect(&apos;/success/url/&apos;)
    else:
        form = UploadFileForm()
    return render(request, &apos;upload.html&apos;, {&apos;form&apos;: form})</code></pre><p>请注意，必须将request.FILES传递到form的构造函数中。</p>
<pre><code>form = UploadFileForm(request.POST, request.FILES)</code></pre><p>下面是一个处理上传文件的方法的参考例子：</p>
<pre><code>def handle_uploaded_file(f):
    with open(&apos;some/file/name.txt&apos;, &apos;wb+&apos;) as destination:
        for chunk in f.chunks():
            destination.write(chunk)</code></pre><p>遍历UploadedFile.chunks()，而不是直接使用read()方法，能确保大文件不会占用系统过多的内存。</p>
<h2 id="走MODELS"><a href="#走MODELS" class="headerlink" title="走MODELS"></a>走MODELS</h2><p>如果是通过模型层的model来指定上传文件的保存方式的话，使用ModelForm更方便。 调用form.save()的时候，文件对象会保存在相应的FileField的upload_to参数指定的地方。</p>
<pre><code>from django.http import HttpResponseRedirect
from django.shortcuts import render
from .forms import ModelFormWithFileField

def upload_file(request):
    if request.method == &apos;POST&apos;:
        form = ModelFormWithFileField(request.POST, request.FILES)
        if form.is_valid():
            # 这么做就可以了，文件会被保存到Model中upload_to参数指定的位置
            form.save()
            return HttpResponseRedirect(&apos;/success/url/&apos;)
    else:
        form = ModelFormWithFileField()
    return render(request, &apos;upload.html&apos;, {&apos;form&apos;: form})</code></pre><p>如果手动构造一个对象，还可以简单地把文件对象直接从request.FILES赋值给模型：</p>
<pre><code>from django.http import HttpResponseRedirect
from django.shortcuts import render
from .forms import UploadFileForm
from .models import ModelWithFileField

def upload_file(request):
    if request.method == &apos;POST&apos;:
        form = UploadFileForm(request.POST, request.FILES)
        if form.is_valid():
            instance = ModelWithFileField(file_field=request.FILES[&apos;file&apos;])
            instance.save()
            return HttpResponseRedirect(&apos;/success/url/&apos;)
    else:
        form = UploadFileForm()
    return render(request, &apos;upload.html&apos;, {&apos;form&apos;: form})</code></pre><h1 id="前端表单常用属性"><a href="#前端表单常用属性" class="headerlink" title="前端表单常用属性"></a>前端表单常用属性</h1><pre><code>属性                         说明
{{ login_form.label }}        字段对应的label信息
{{ login_form.label_tag }}    自动生成字段的label标签，注意与{{ login_form.label }}的区别。
{{ login_form.id_for_label }}    自定义字段标签的id
{{ login_form.value }}         当前字段的值，比如一个Email字段的值someone@example.com
{{ login_form.html_name }}     指定字段生成的input标签中name属性的值
{{ login_form.help_text }}     字段的帮助信息
{{ login_form.errors }}         包含错误信息的元素
{{ login_form.is_hidden }}     用于判断当前字段是否为隐藏的字段，如果是，返回True
{{ login_form.field }}         返回字段的参数列表。例如{{ char_field.field.max_length }}</code></pre><h1 id="表单内置的Field类"><a href="#表单内置的Field类" class="headerlink" title="表单内置的Field类"></a>表单内置的Field类</h1><p><a href="http://www.liujiangblog.com/course/django/154" target="_blank" rel="noopener">转载地址，侵删URL</a></p>
<p>对于每个字段类，介绍其默认的widget，当输入为空时返回的值，以及采取何种验证方式。‘规范化为’表示转换为PYthon的何种对象。可用的错误信息键，表示该字段可自定义错误信息的类型（字典的键）。</p>
<h2 id="1-BooleanField"><a href="#1-BooleanField" class="headerlink" title="1. BooleanField"></a>1. BooleanField</h2><pre><code>默认的Widget：CheckboxInput
空值：False
规范化为：Python的True或者False
可用的错误信息键：required</code></pre><p>##2. CharField</p>
<pre><code>默认的Widget：TextInput
空值：与empty_value给出的任何值。
规范化为：一个Unicode 对象。
验证max_length或min_length，如果设置了这两个参数。 否则，所有的输入都是合法的。
可用的错误信息键：min_length, max_length, required
有四个可选参数：

max_length，min_length：设置字符串的最大和最小长度。
strip：如果True（默认），去除输入的前导和尾随空格。
empty_value：用来表示“空”的值。 默认为空字符串。</code></pre><p>##3. ChoiceField<br>    默认的Widget：Select<br>    空值：’’（一个空字符串）<br>    规范化为：一个Unicode 对象。<br>    验证给定的值是否在选项列表中。<br>    可用的错误信息键：required, invalid_choice<br>    参数choices：用来作为该字段选项的一个二元组组成的可迭代对象（例如，列表或元组）或者一个可调用对象。格式与用于和ORM模型字段的choices参数相同。</p>
<p>##4. TypedChoiceField<br>    像ChoiceField一样，只是还有两个额外的参数：coerce和empty_value。</p>
<pre><code>默认的Widget：Select
空值：empty_value参数设置的值。
规范化为：coerce参数类型的值。
验证给定的值在选项列表中存在并且可以被强制转换。
可用的错误信息的键：required, invalid_choice</code></pre><p>##5. DateField<br>    默认的Widget：DateInput<br>    空值：None<br>    规范化为：datetime.date对象。<br>    验证给出的值是一个datetime.date、datetime.datetime 或指定日期格式的字符串。<br>    错误信息的键：required, invalid<br>    接收一个可选的参数：input_formats。一个格式的列表，用于转换字符串为datetime.date对象。</p>
<pre><code>如果没有提供input_formats，默认的输入格式为：

[&apos;%Y-%m-%d&apos;,      # &apos;2006-10-25&apos;
 &apos;%m/%d/%Y&apos;,      # &apos;10/25/2006&apos;
 &apos;%m/%d/%y&apos;]      # &apos;10/25/06&apos;
另外，如果你在设置中指定USE_L10N=False，以下的格式也将包含在默认的输入格式中：

[&apos;%b %d %Y&apos;,      # &apos;Oct 25 2006&apos;
 &apos;%b %d, %Y&apos;,     # &apos;Oct 25, 2006&apos;
 &apos;%d %b %Y&apos;,      # &apos;25 Oct 2006&apos;
 &apos;%d %b, %Y&apos;,     # &apos;25 Oct, 2006&apos;
 &apos;%B %d %Y&apos;,      # &apos;October 25 2006&apos;
 &apos;%B %d, %Y&apos;,     # &apos;October 25, 2006&apos;
 &apos;%d %B %Y&apos;,      # &apos;25 October 2006&apos;
 &apos;%d %B, %Y&apos;]     # &apos;25 October, 2006&apos;</code></pre><p>##6. DateTimeField<br>    默认的Widget：DateTimeInput<br>    空值：None<br>    规范化为：Python的datetime.datetime对象。<br>    验证给出的值是一个datetime.datetime、datetime.date或指定日期格式的字符串。<br>    错误信息的键：required, invalid<br>    接收一个可选的参数：input_formats</p>
<pre><code>如果没有提供input_formats，默认的输入格式为：

[&apos;%Y-%m-%d %H:%M:%S&apos;,    # &apos;2006-10-25 14:30:59&apos;
 &apos;%Y-%m-%d %H:%M&apos;,       # &apos;2006-10-25 14:30&apos;
 &apos;%Y-%m-%d&apos;,             # &apos;2006-10-25&apos;
 &apos;%m/%d/%Y %H:%M:%S&apos;,    # &apos;10/25/2006 14:30:59&apos;
 &apos;%m/%d/%Y %H:%M&apos;,       # &apos;10/25/2006 14:30&apos;
 &apos;%m/%d/%Y&apos;,             # &apos;10/25/2006&apos;
 &apos;%m/%d/%y %H:%M:%S&apos;,    # &apos;10/25/06 14:30:59&apos;
 &apos;%m/%d/%y %H:%M&apos;,       # &apos;10/25/06 14:30&apos;
 &apos;%m/%d/%y&apos;]             # &apos;10/25/06&apos;</code></pre><h2 id="7-DecimalField"><a href="#7-DecimalField" class="headerlink" title="7. DecimalField"></a>7. DecimalField</h2><pre><code>默认的Widget：当Field.localize是False时为NumberInput，否则为TextInput。
空值：None
规范化为：Python decimal对象。
验证给定的值为一个十进制数。 忽略前导和尾随的空白。
错误信息的键：max_whole_digits, max_digits, max_decimal_places,max_value, invalid, required,min_value
接收四个可选的参数：

max_value,min_value:允许的值的范围，需要赋值decimal.Decimal对象，不能直接给个整数类型。

max_digits：值允许的最大位数（小数点之前和之后的数字总共的位数，前导的零将被删除）。

decimal_places：允许的最大小数位。</code></pre><p>##8. DurationField<br>    默认的Widget：TextInput<br>    空值：None<br>    规范化为：Python timedelta。<br>    验证给出的值是一个字符串，而且可以转换为timedelta对象。<br>    错误信息的键：required, invalid.<br>    9. EmailField<br>    默认的Widget：EmailInput<br>    空值：’’（一个空字符串）<br>    规范化为：Unicode 对象。<br>    使用正则表达式验证给出的值是一个合法的邮件地址。<br>    错误信息的键：required, invalid<br>    两个可选的参数用于验证，max_length 和min_length。</p>
<p>##10. FileField<br>    默认的Widget：ClearableFileInput<br>    空值：None<br>    规范化为：一个UploadedFile对象，它封装文件内容和文件名到一个对象内。<br>    验证非空的文件数据已经绑定到表单。<br>    错误信息的键：missing, invalid, required, empty, max_length<br>    具有两个可选的参数用于验证：max_length 和 allow_empty_file。</p>
<p>##11. FilePathField<br>    默认的Widget：Select<br>    空值：None<br>    规范化为：Unicode 对象。<br>    验证选择的选项在选项列表中存在。<br>    错误信息的键：required, invalid_choice<br>    这个字段允许从一个特定的目录选择文件。 它有五个额外的参数，其中的path是必须的：</p>
<pre><code>path：要列出的目录的绝对路径。 这个目录必须存在。

recursive：如果为False（默认值），只用直接位于path下的文件或目录作为选项。如果为True，将递归访问这个目录，其内所有的子目录和文件都将作为选项。

match：正则表达模式；只有具有与此表达式匹配的文件名称才被允许作为选项。

allow_files：可选。默认为True。表示是否应该包含指定位置的文件。它和allow_folders必须有一个为True。

allow_folders可选。默认为False。表示是否应该包含指定位置的目录。</code></pre><p>##12. FloatField<br>    默认的Widget：当Field.localize是False时为NumberInput，否则为TextInput。<br>    空值：None<br>    规范化为：Float 对象。<br>    验证给定的值是一个浮点数。<br>    错误信息的键：max_value, invalid, required, min_value<br>    接收两个可选的参数用于验证，max_value和min_value，控制允许的值的范围。</p>
<p>##13. ImageField<br>    默认的Widget：ClearableFileInput<br>    空值：None<br>    规范化为：一个UploadedFile 象，它封装文件内容和文件名为一个单独的对象。<br>    验证文件数据已绑定到表单，并且该文件是Pillow可以解析的图像格式。<br>    错误信息的键：missing, invalid, required, empty, invalid_image<br>    使用ImageField需要安装Pillow（pip install pillow）。如果在上传图片时遇到图像损坏错误，通常意味着使用了Pillow不支持的格式。</p>
<p>##14. IntegerField<br>    默认的Widget：当Field.localize是False时为NumberInput，否则为TextInput。<br>    空值：None<br>    规范化为：Python 整数或长整数。<br>    验证给定值是一个整数。 允许前导和尾随空格，类似Python的int()函数。<br>    错误信息的键：max_value, invalid, required, min_value<br>    两个可选参数：max_value和min_value，控制允许的值的范围。</p>
<p>##15. GenericIPAddressField<br>    包含IPv4或IPv6地址的字段。</p>
<pre><code>默认的Widget：TextInput
空值：&apos;&apos;（一个空字符串）
规范化为：一个Unicode对象。
验证给定值是有效的IP地址。
错误信息的键：required, invalid
有两个可选参数：protocol和unpack_ipv4</code></pre><p>##16. MultipleChoiceField<br>    默认的Widget：SelectMultiple<br>    空值：[]（一个空列表）<br>    规范化为：一个Unicode 对象列表。<br>    验证给定值列表中的每个值都存在于选择列表中。<br>    错误信息的键：invalid_list, invalid_choice, required<br>##17. TypedMultipleChoiceField<br>    类似MultipleChoiceField，除了需要两个额外的参数，coerce和empty_value。</p>
<pre><code>默认的Widget：SelectMultiple
空值：empty_value
规范化为：coerce参数提供的类型值列表。
验证给定值存在于选项列表中并且可以强制。
错误信息的键：required, invalid_choice</code></pre><p>##18. NullBooleanField<br>    默认的Widget：NullBooleanSelect<br>    空值：None<br>    规范化为：Python None, False 或True 值。<br>    不验证任何内容（即，它从不引发ValidationError）。<br>##19.RegexField<br>    默认的Widget：TextInput<br>    空值：’’（一个空字符串）<br>    规范化为：一个Unicode 对象。<br>    验证给定值与某个正则表达式匹配。<br>    错误信息的键：required, invalid<br>    需要一个必需的参数：regex，需要匹配的正则表达式。</p>
<pre><code>还可以接收max_length，min_length和strip参数，类似CharField。</code></pre><p>##20. SlugField<br>    默认的Widget：TextInput<br>    空值：’’（一个空字符串）<br>    规范化为：一个Unicode 对象。<br>    验证给定的字符串只包括字母、数字、下划线及连字符。<br>    错误信息的键：required, invalid<br>    此字段用于在表单中表示模型的SlugField。</p>
<p>##21. TimeField<br>    默认的Widget：TextInput<br>    空值：None<br>    规范化为：一个Python 的datetime.time 对象。<br>    验证给定值是datetime.time或以特定时间格式格式化的字符串。<br>    错误信息的键：required, invalid<br>    接收一个可选的参数：input_formats，用于尝试将字符串转换为有效的datetime.time对象的格式列表。</p>
<pre><code>如果没有提供input_formats，默认的输入格式为：

&apos;%H:%M:%S&apos;,     # &apos;14:30:59&apos;
&apos;%H:%M&apos;,        # &apos;14:30&apos;</code></pre><p>##22. URLField<br>    默认的Widget：URLInput<br>    空值：’’（一个空字符串）<br>    规范化为：一个Unicode 对象。<br>    验证给定值是个有效的URL。<br>    错误信息的键：required, invalid<br>    可选参数：max_length和min_length</p>
<p>##23. UUIDField<br>    默认的Widget：TextInput<br>    空值：’’（一个空字符串）<br>    规范化为：UUID对象。<br>    错误信息的键：required, invalid<br>##24. ComboField<br>    默认的Widget：TextInput<br>    空值：’’（一个空字符串）<br>    规范化为：Unicode 对象。<br>    根据指定为ComboField的参数的每个字段验证给定值。<br>    错误信息的键：required, invalid<br>    接收一个额外的必选参数：fields，用于验证字段值的字段列表（按提供它们的顺序）。</p>
<pre><code>&gt;&gt;&gt; from django.forms import ComboField
&gt;&gt;&gt; f = ComboField(fields=[CharField(max_length=20), EmailField()])
&gt;&gt;&gt; f.clean(&apos;test@example.com&apos;)
&apos;test@example.com&apos;
&gt;&gt;&gt; f.clean(&apos;longemailaddress@example.com&apos;)
Traceback (most recent call last):
...
ValidationError: [&apos;Ensure this value has at most 20 characters (it has 28).&apos;]</code></pre><p>##25. MultiValueField<br>    默认的Widget：TextInput<br>    空值：’’（一个空字符串）<br>    规范化为：子类的compress方法返回的类型。<br>    根据指定为MultiValueField的参数的每个字段验证给定值。<br>    错误信息的键：incomplete, invalid, required<br>##26. SplitDateTimeField<br>    默认的Widget：SplitDateTimeWidget<br>    空值：None<br>    规范化为：Python datetime.datetime 对象。<br>    验证给定的值是datetime.datetime或以特定日期时间格式格式化的字符串。<br>    错误信息的键：invalid_date, invalid, required, invalid_time</p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Sxadmin</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://sxadmin.github.io/2019/07/08/Django-%E8%A1%A8%E5%8D%95%E5%A4%84%E7%90%86/">https://sxadmin.github.io/2019/07/08/Django-%E8%A1%A8%E5%8D%95%E5%A4%84%E7%90%86/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://sxadmin.github.io" target="_blank">Sxadmin blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/cover/cover8.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2019/07/11/Django-%E6%A8%A1%E6%9D%BF%E5%B1%82/"><img class="prev_cover" src="/img/cover/cover68.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Django-模板层</div></div></a></div><div class="next-post pull_right"><a href="/2019/07/07/Django-%E7%9F%A5%E8%AF%86%E5%9B%9E%E9%A1%BE%E5%81%9A%E4%B8%AA%E5%B0%8FDEMO/"><img class="next_cover" src="/img/cover/cover93.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Django-知识回顾做个小DEMO</div></div></a></div></nav></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Sxadmin</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script></body></html>